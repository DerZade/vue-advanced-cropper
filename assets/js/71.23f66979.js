(window.webpackJsonp=window.webpackJsonp||[]).push([[71],{337:function(e,t,o){e.exports=o.p+"assets/img/problem.e450a440.svg"},496:function(e,t,o){"use strict";o.r(t);var r=o(1),s=Object(r.a)({},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"cross-origin"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#cross-origin","aria-hidden":"true"}},[e._v("#")]),e._v(" Cross-Origin")]),e._v(" "),r("h2",{attrs:{id:"introduction"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#introduction","aria-hidden":"true"}},[e._v("#")]),e._v(" Introduction")]),e._v(" "),r("p",[e._v("Sometimes, you need to crop the images stored on some other origin (i.e. other domain, port or protocol).")]),e._v(" "),r("p",[e._v("Such requests are called "),r("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS",target:"_blank",rel:"noopener noreferrer"}},[e._v("cross-origin requests"),r("OutboundLink")],1),e._v(". For security reasons, browsers restrict cross-origin HTTP requests initiated from scripts.")]),e._v(" "),r("blockquote",[r("p",[e._v("For example, you've authenticated on site A, where you store some private documents. Then you visit site B. It is able (strictly, it depends on same-site cookie policy) to display you your private images from the site A, but due the CORS policy site B can't get access to their content from scripts. So your documents in safety.")])]),e._v(" "),r("p",[e._v("The situation when you need to get private images from an other site to crop ones seems unlikely, but the important part that you can't get the access to "),r("strong",[e._v("any cross-origin images")]),e._v(" from the scripts by default.")]),e._v(" "),r("h2",{attrs:{id:"how-does-it-relate-to-cropper"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#how-does-it-relate-to-cropper","aria-hidden":"true"}},[e._v("#")]),e._v(" How does it relate to cropper?")]),e._v(" "),r("p",[e._v("First of all there are two approaches to crop an image.")]),e._v(" "),r("h3",{attrs:{id:"client-side"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#client-side","aria-hidden":"true"}},[e._v("#")]),e._v(" Client-side")]),e._v(" "),r("p",[e._v("The most common approach is the cropping image on client-side and sending a cropped binary fragment to a backend. But there is a catch: scripts can't access to a content of cross-origin image by default as mentioned above. So they can't get the canvas content and can't form a binary data for a backend therefore.")]),e._v(" "),r("p",[e._v("This problem can be solved only by the appropriate storage configuring as written in the next section.")]),e._v(" "),r("p",[r("img",{attrs:{src:o(337),alt:"Internal structure"}})]),e._v(" "),r("h3",{attrs:{id:"server-side"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#server-side","aria-hidden":"true"}},[e._v("#")]),e._v(" Server-side")]),e._v(" "),r("p",[e._v("Otherwise, you can choice an area on client-side and send coordinates with an image link to your backend. A backend ignores the CORS policy, so it can be easily cropped on server side based on received coordinates.")]),e._v(" "),r("p",[e._v("To implement this approach just disable the using of the canvas to crop images by setting "),r("code",[e._v("canvas")]),e._v(" prop to "),r("code",[e._v("false")]),e._v(".")]),e._v(" "),r("h2",{attrs:{id:"configuring-the-storage"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#configuring-the-storage","aria-hidden":"true"}},[e._v("#")]),e._v(" Configuring the storage")]),e._v(" "),r("p",[e._v("To allow scripts to get content of an image the "),r("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin",target:"_blank",rel:"noopener noreferrer"}},[r("code",[e._v("Access-Control-Allow-Origin")]),r("OutboundLink")],1),e._v(" header should be added to the image response headers.")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("Access-Control-Allow-Origin: https://website-with-cropper.me\n")])])]),r("p",[e._v("If you have no access to storage this try to crop an image on the server-side or use some type of proxying.")]),e._v(" "),r("p",[e._v("The guides to configure CORS settings for different web storages:")]),e._v(" "),r("ul",[r("li",[r("p",[r("a",{attrs:{href:"https://cloud.google.com/storage/docs/configuring-cors",target:"_blank",rel:"noopener noreferrer"}},[e._v("Google Cloud"),r("OutboundLink")],1)])]),e._v(" "),r("li",[r("p",[r("a",{attrs:{href:"https://docs.aws.amazon.com/AmazonS3/latest/dev/cors-troubleshooting.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Amazon Cloud"),r("OutboundLink")],1)])])])])},[],!1,null,null,null);t.default=s.exports}}]);